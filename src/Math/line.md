本文介绍计算几何中常用的直线方程和直线性质。下面用圆括号(x,y)表示点的坐标，用方括号[x,y]表示方向矢量。

##一、平面直线

### 1. 两点式

过两点$(x_a,y_a)$和$(x_b,y_b)$的直线方程是：
$$ x(y_a-y_b) + y(x_b-x_a) + x_ay_b - x_by_a = 0 $$

### 2.点向式

过点$(x_0,y_0)$且平行于$[l_x,l_y]$的直线方程是：
$$ l_yx - l_xy + l_xy_0 - l_yx_0 = 0 $$

### 3.点法式

过点$(x_0,y_0)$且垂直于$[n_x,n_y]$的直线方程可由$[ l_x,l_y]=[-n_y,n_x]$得到：
$$ n_xx + n_yy - n_xx_0 - n_yy_0 = 0 $$

### 4.角距式

设法向的方向角为 θ，原点到直线的距离为 ρ。由点法式可推出直线方程为：
$$ x\cos θ + y\sin θ = ρ$$

### 5.一般式

上述直线方程都可以写成一般式：
$$ Ax+By+C=0 $$

## 二、直线性质

### 1.点到直线的距离

点$(x_0,y_0)$到直线的距离为：
$$ d = \frac {|Ax_0+By_0+C|}{\sqrt{A^2+B^2}}$$

两条平行线$ Ax+By+C_1=0 $和$ Ax+By+C_2=0 $的距离为：
$$ d = \frac {|C_1-C_2|}{\sqrt{A^2+B^2}}$$

所以$ Ax+By+C=0 $可以看作是过原点的直线$ Ax+By=0 $平移了$ d = \frac {|C|}{\sqrt{A^2+B^2}}$，并且垂直于点(A,B)和原点之间的连线。

### 2.归一化

取$a=\frac{A}{\sqrt{A^2+B^2}}, b=\frac {B}{\sqrt{A^2+B^2}}, c=\frac {C}{\sqrt{A^2+B^2}}$，可得归一化的一般式方程：
$$ ax+by+c=0 $$
点$(x_0,y_0)$到直线的距离为：
$$ d = |ax_0+by_0+c|$$

### 3.两条直线的夹角

两条直线$ A_1x+B_1y+C_1=0 $和$ A_2x+B_2y+C_2=0 $的倾角分别为 α 和 β，夹角 θ=α-β 的计算方法如下：
$$ tan(α-β) = \frac{tanα - tanβ}{1 + tanα\cdot tanβ} = \frac{A_2B_1-A_1B_2}{A_1A_2+B_1B_2}=\frac{|\vec{l_1}|\cdot|\vec{l_2}|sinθ}{|\vec{l_1}|\cdot|\vec{l_2}|cosθ}=tanθ $$

### 4.直线的交点

将两个直线方程联立，得到一个方程组：

$$
\begin{cases}
A_1x+B_1y+C_1=0 \\
A_2x+B_2y+C_2=0
\end{cases}
$$

可以解出交点坐标为：$x=\frac{B_1C_2-B_2C_1}{A_1B_2-A_2B_1}$, $y=\frac{A_2C_1-A_1C_2}{A_1B_2-A_2B_1}$.
当$A_1B_2-A_2B_1=0$时，两条直线平行，或者说交点在无穷远处。

### 5.拟合直线

给定 n 个点，拟合一条直线使得这些点到该直线的距离之和最小。假设直线的系数为(a,b,c)，将点的坐标代入可以得到一组线性方程：

$$
\begin{gathered}
ax_1 + by_1 + c = 0 \\
ax_2 + by_2 + c = 0 \\
... \\
ax_n + by_n + c = 0
\end{gathered}
$$

写成矩阵形式为：

$$
\begin{bmatrix}
   x_1 & y_1 & 1 \\
   x_2 & y_2 & 1 \\
   | & | & | & \\
   x_n & y_n & 1 \\
\end{bmatrix}
\begin{bmatrix}
   a \\ b \\ c
\end{bmatrix}=Av=0
$$

当点的个数 ≤3 时，可以求矩阵 A 的零向量得到拟合的直线；
当点的个数>3 时，可以用最小二乘法求$AᵀA$的最小本征值对应的本征向量作为拟合的结果。

### 6. 线性组合

两条直线$ a_1x+b_1y+c_1=0 $和$ a_2x+b_2y+c_2=0 $的线性组合：

$$
(λa_1+(1-λ)a_2)x + (λb_1+(1-λ)b_2)y +(λc_1+(1-λ)c_2) = 0
$$

是通过这两条直线的交点的一簇直线。

两个点$(x_1,y_1),(x_2,y_2)$的线性组合$(λx_1+(1-λ)x_2, λy_1+(1-λ)y_2)$是过这两点的直线上的点。

## 三、空间直线

### 1. 两点式

经过点 a 和 b 的直线为：$x=a+λ(b-a)$

### 2. 两向式

直线方向为 m，过原点和直线的平面法向为 n，直线方程为：$ x \times m = n$

### 3. 点向式

过点 a，方向为 n 的直线为：$x=a+λn$

### 4. 点到直线的距离

点 b 到直线$x=a+λn$距离是 b-a 与 n 组成平行四边形，以 n 为底求高：

$$
d = \frac{|(b-a) \times n|}{|n|}
$$

### 5. 两条直线的距离

两条异面直线$x=a+λp$和$x=b+µq$最短距离是三个向量组成的平行六面体的高：

$$
d = \frac{1}{|p \times q|}\det\begin{bmatrix}
   b-a \\ p \\ q
\end{bmatrix}
$$

距离最近处的连线同时垂直与这两条直线，所以

$$
\begin{gathered}
(a+λp - b-µq) \cdot p= 0 \\
(a+λp - b-µq) \cdot q= 0
\end{gathered}
\implies
\begin{gathered}
λp \cdot p - µq \cdot p = (b-a) \cdot p \\
λp \cdot q - µq \cdot q= (b-a) \cdot q
\end{gathered}
$$

解出 λ 和 µ，就可以得到两条直线上距离最近的两个点。
